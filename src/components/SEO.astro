---
import { siteConfig } from "@/site.config";

interface Props {
  title: string;
  description: string;
  // Optional overrides for post pages
  type?: "website" | "article";
  publishedTime?: Date;
  tags?: string[];
  image?: string;   // relative path or absolute URL
  noindex?: boolean;
}

const {
  title,
  description,
  type = "website",
  publishedTime,
  tags,
  image,
  noindex = false,
} = Astro.props;

const pageTitle   = `${title} | ${siteConfig.title}`;
const canonical   = new URL(Astro.url.pathname, siteConfig.url).href;
const ogImage     = image
  ? new URL(image, siteConfig.url).href
  : new URL("/og-default.png", siteConfig.url).href;
---

<!-- Core -->
<title>{pageTitle}</title>
<meta name="description" content={description} />
<link rel="canonical" href={canonical} />
{noindex && <meta name="robots" content="noindex, nofollow" />}

<!-- Open Graph -->
<meta property="og:title"       content={pageTitle} />
<meta property="og:description" content={description} />
<meta property="og:url"         content={canonical} />
<meta property="og:site_name"   content={siteConfig.title} />
<meta property="og:type"        content={type} />
<meta property="og:image"       content={ogImage} />
{type === "article" && publishedTime && (
  <meta property="article:published_time" content={publishedTime.toISOString()} />
)}
{type === "article" && tags?.map((tag) => (
  <meta property="article:tag" content={tag} />
))}

<!-- Twitter / X -->
<meta name="twitter:card"        content="summary_large_image" />
<meta name="twitter:title"       content={pageTitle} />
<meta name="twitter:description" content={description} />
<meta name="twitter:image"       content={ogImage} />